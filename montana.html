 <!DOCTYPE html>
    <html>
    <head>
        <title>test</title>
        <script type="text/javascript" src="d3.v6.js"></script>
        <script type="text/javascript" src="montana.js"></script>
<style>
    body{
        font-family:helvetica;
    }
    #main{
        width:800px;
        height:100%;
        display:inline-block;
        vertical-align:top;
        padding:10px;
        margin:2%;
        column-count: 6;
        column-gap: 40px;
        column-rule: 1px #000 solid;
    }
    .subheading {
      font-size:14px;
      font-weight:700;
      line-height:120%;
    }
    .subheadingNumber {
      font-size:8px;
      display:inline-block;
    }
    .content {
     font-size:3px;
      display:inline-block;
      line-height: 100%;
    }
    p{
     display:inline-block;
     padding:0px;
     padding-left:10px;
    }
/*   
    .notAmended{
    background-color:#aaa;}

    .amended{
    background-color:gold;} */
    .subSectionNumber{
        font-size:2px;
        line-height:150%;
        text-decoration:underline;
        text-decoration-thickness:2px; }

    .subSectionTitle{
        font-size:2px;   
         line-height:150%;
        text-decoration:underline;
        text-decoration-thickness:2px;
}

    .subSectionText{
        font-size:2px;   
        line-height:150%;
        text-decoration:underline;
        text-decoration-thickness:2px;
    }

    #mouseover{
        width:200px;
        background-color: rgba(255,255,255,.95);
        border:1px solid black;
        padding:10px;
        font-size:11px;
        position:absolute;
        visibility:hidden;
    }
    #state{
        font-size:24px;
        font-weight:700;
        margin-left:40px;
    }#title{
        font-size:12px;
        font-weight:700;
        margin-left:40px;
    }
    #key{margin-left:40px;}
</style>

    </head>
    <body>
       
        <div id="state"> THIS IS A TEST<br> <br>Montana</div>
        <div id = "title"><br> State constitution amendments over time</div>
        <div id = "key"></div>
        <div id = "main"></div>
        <div id = "mouseover">text</div>
        <script>
           // console.log(montana)
            var colorScale = d3.scaleLinear().domain([1800,1970,1980,1990,2000,2010,2020])
           // .range(["#555","#d7da4b","#62d8ab","#77db43","#9ea147","#95df83","#4f9549"])
            .range(["#aaa","#B7C9CE","#92B7C3","#6EA6B7","#4994AB","#2583A0","#007194"])
            //.range(["#000000","#2A0000","#550000","#800000","#AA0000","#D50000","#FF0000"])
           // .range(["#B0B0B0","#BA9799","#C47F81","#CF666A","#D94D53","#E3353B","#ED1C24"])
                var key = d3.select("#key").append("svg").attr("width",600).attr("height",40)
                var rectW = 80
                key.selectAll("rect").data(colorScale.domain())
                .enter()
                .append("rect")
                .attr("x",function(d,i){return i*rectW})
                .attr("y",20)
                .attr("width",rectW-1)
                .attr("height",10)
                .attr("fill",function(d,i){
                    return colorScale.range()[i]
                })
                 key.selectAll("text").data(colorScale.domain())
                .enter()
                .append("text")
                .attr("x",function(d,i){return i*rectW})
                .attr("y",18)
                .style("font-size",12)
                .text(function(d,i){
                    if(d==1800){
                        return "Unchanged"
                    }return d+"s"
                })

            
            var section = d3.select("#main")
            for(var i in montana){
                //console.log(montana[i])//.append("div").attr("class","section")
                var subsection = section.append("div")

                subsection.append("div").attr("class","subheadingNumber")
                .html(montana[i].article)
                
                subsection.append("div").attr("class","subheading")
                .html(montana[i].title)

                for(var t in montana[i].text){
                    var subSectionNumber = montana[i].text[t].section
                    var subSectionTitle = montana[i].text[t].sectionTitle
                    var subSectionText = montana[i].text[t].secText
                    
                        if(montana[i].text[t].lastAmended!=undefined){
                            var year = montana[i].text[t].lastAmended

                            var color = colorScale(year).replace(")",",0)")
                            var decColor = colorScale(year)
                                                if(subSectionTitle!=undefined){
                            subsection.append("div").attr("class","amended subSectionNumber item")
                            .html(subSectionNumber).style("color",color).attr("year",year).style("text-decoration-color",decColor)
                            subsection.append("div").attr("class","amended subSectionTitle item")
                            .html(subSectionTitle).style("color",color).attr("year",year).style("text-decoration-color",decColor)
                                    

                    }
                            subsection.append("div").attr("class","amended subSectionText item")
                            .html(subSectionText).style("color",color).attr("year",year)
                            .style("text-decoration-color",decColor)
        
                        }else{

                   // if(subSectionTitle!=undefined){
                            var year = 1800
                            var color = colorScale(year).replace(")",",0)")
                            var decColor = colorScale(year)

                            subsection.append("div").attr("class","notAmended subSectionNumber item")
                            .html(subSectionNumber+" "+subSectionTitle).style("color",color).attr("year",year)                            
                            .style("text-decoration-color",color)


                   // }
                            subsection.append("div")
                            .html(subSectionText).attr("class","notAmended subSectionText item")
                            .style("color",color).attr("year",year)
                            .style("text-decoration-color",decColor)
                        }
                    
                }
                


                var item = d3.selectAll(".item").style("cursor","pointer")
                .on("mouseover",function(e){
                    var highlightText = d3.select(this).html()
                    var year = d3.select(this).attr("year")
                    var color = d3.select(this).style("text-decoration-color")//.replace(", 0)",")")
                    console.log(color)
                    if(year ==1800 || year ==null){
                        var amendText = ""
                    }else{
                      var amendText = "<b>Last amended in "+year+"<br><br></b>"
                    }
                    d3.select("#mouseover").html(amendText+highlightText).style("color",color)
                    .style("left",(e.clientX)+"px")
                    .style("top",(e.clientY+20)+"px")  
                    .style("visibility","visible")                  
                })
                 .on("mouseout",function(e){
                    d3.select("#mouseover")
                    .style("visibility","hidden")                  
                })

            }
        </script>
    </body>
    </html>